define(["durandal/app","plugins/dialog","knockout","jquery","services/logger","services/dataservice","services/navigating","Q","services/scripts"],function(n,t,i,r,u,f,e,o,s){function c(n){e.showBusy(!0);var t=o.all([f.getRoleList(n.listOfRoles),f.getUserRoles(n.listOfUserRoles,n.editRole.userName())]);t.then(function(){e.busy(!1)}).fail(function(){e.busy(!1)})}var h=function(n){this.listOfRoles=i.observableArray([]),this.listOfUserRoles=i.observableArray([]),this.title="Roles for '"+n+"'",this.editRole={userName:i.observable(n),roleName:i.observable("")}};return h.prototype.closeModal=function(){t.close(this,"close")},h.prototype.activate=function(){e.showBusy(!0);var n=o.all([f.getRoleList(this.listOfRoles),f.getUserRoles(this.listOfUserRoles,this.editRole.userName())]);return n.then(function(){e.busy(!1)}).fail(function(){e.busy(!1)})},h.prototype.attached=function(){var n=this;r("#userRoles").sortable({connectWith:".connectedSortable",receive:function(t,i){var o=r.map(i.item,function(n){return r(n).attr("data-id")}),h;n.editRole.roleName(o[0]),e.busy(!0),h=f.addRoleToUser(n.editRole),h.then(function(){u.log("Role "+o[0]+" was added",null,null,!0),e.busy(!1),c(n)}).fail(function(t){u.logError("We encountered an error adding the role: "+s.jsonMessage(t),null,null,!0),e.busy(!1),c(n)})}}).disableSelection(),r("#siteRoles").sortable({connectWith:".connectedSortable",receive:function(t,i){var o=r.map(i.item,function(n){return r(n).attr("data-id")}),h;n.editRole.roleName(o[0]),h=f.deleteRoleFromUser(n.editRole),h.then(function(){u.log("Role "+o[0]+" was deleted",null,null,!0),e.busy(!1),c(n)}).fail(function(t){u.logError("We encountered an error deleting the role: "+s.jsonMessage(t),null,null,!0),e.busy(!1),c(n)})}}).disableSelection()},h});
//@ sourceMappingURL=userRolesModel.min.js.map