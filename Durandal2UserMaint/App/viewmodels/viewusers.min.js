define(["durandal/app","services/navigating","knockout","services/dataservice","jquery","services/logger","models/editUserModel","models/addUserModel","models/resetPasswordModel","models/userRolesModel","services/scripts"],function(n,t,i,r,u,f,e,o,s,h,c){function l(){t.busy(!0);var n=r.getUserList(a);return n.then(function(){t.busy(!1)}).fail(function(){t.busy(!1)})}var a=i.observableArray([]),v=function(){return l()},y=function(n){p(n)},p=function(n){u(n).on("click",".viewRoles",function(){var n=i.dataFor(this);w(n)});u(n).on("click",".editUser",function(){var n=i.dataFor(this);b(n)});u(n).on("click",".resetPassword",function(){var n=i.dataFor(this);k(n)})},w=function(t){var i=new h(t.UserName);i.viewUrl="views/userroles",n.showDialog(i).then(function(){})},b=function(t){var i=new e(t.UserName,t.Email,t.IsActive);i.viewUrl="views/edituser",n.showDialog(i).then(function(n){if(n==="update"){var t=r.updateUser(i);t.then(function(){f.log("User has been updated",null,null,"viewusers",!0),l()}).fail(function(n){f.logError("We encountered an error updating user: "+c.jsonMessage(n),null,"viewusers",!0)})}else f.logWarning("The user was NOT updated",null,"viewusers",!0)})},k=function(t){var i=new s(t.UserName);i.viewUrl="views/resetpassword",n.showDialog(i).then(function(n){if(n==="update"){var t=r.resetPassword(i);t.then(function(){f.log("Password has been reset",null,null,"viewusers",!0),l()}).fail(function(n){f.logError("We encountered an error updating user's password: "+c.jsonMessage(n),null,"viewusers",!0)})}else f.logWarning("The user was NOT udpated",null,"viewusers",!0)})},d=function(){var t=new o("","",!0,"");t.viewUrl="views/adduser",n.showDialog(t).then(function(n){if(n==="update"){var i=r.addUser(t);i.then(function(){f.log("User hase been added",null,null,"viewusers",!0),l()}).fail(function(n){f.logError("We encountered an error updating user: "+c.jsonMessage(n),null,"viewusers",!0)})}else f.logWarning("The user was NOT added",null,"viewusers",!0)})};return{title:"View Site Users",description:"Here is a list of the users on the site.",activate:v,attached:y,listOfUsers:a,addUser:d}});
//@ sourceMappingURL=viewusers.min.js.map