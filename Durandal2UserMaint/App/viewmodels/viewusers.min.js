define(["durandal/app","services/navigating","knockout","services/dataservice","jquery","services/logger","models/editUserModel","models/addUserModel","models/resetPasswordModel","services/scripts"],function(n,t,i,r,u,f,e,o,s,h){function c(){t.busy(!0);var n=r.getUserList(l);return n.then(function(){t.busy(!1)}).fail(function(){t.busy(!1)})}var l=i.observableArray([]),a=function(){return c()},v=function(n){y(n)},y=function(n){u(n).on("click",".viewRoles",function(){var n=i.dataFor(this);p(n)});u(n).on("click",".editUser",function(){var n=i.dataFor(this);w(n)});u(n).on("click",".resetPassword",function(){var n=i.dataFor(this);b(n)})},p=function(){n.showMessage("Not implemented yet","Sorry")},w=function(t){var i=new e(t.UserName,t.Email,t.IsActive);i.viewUrl="views/edituser",n.showDialog(i).then(function(n){if(n==="update"){var t=r.updateUser(i);t.then(function(){f.log("User has been updated",null,null,"viewusers",!0),c()}).fail(function(n){f.logError("We encountered an error updating user: "+h.jsonMessage(n),null,"viewusers",!0)})}else f.logWarning("The user was NOT updated",null,"viewusers",!0)})},b=function(t){var i=new s(t.UserName);i.viewUrl="views/resetpassword",n.showDialog(i).then(function(n){if(n==="update"){var t=r.resetPassword(i);t.then(function(){f.log("Password has been reset",null,null,"viewusers",!0),c()}).fail(function(n){f.logError("We encountered an error updating user's password: "+h.jsonMessage(n),null,"viewusers",!0)})}else f.logWarning("The user was NOT udpated",null,"viewusers",!0)})},k=function(){var t=new o("","",!0,"");t.viewUrl="views/adduser",n.showDialog(t).then(function(n){if(n==="update"){var i=r.addUser(t);i.then(function(){f.log("User hase been added",null,null,"viewusers",!0),c()}).fail(function(n){f.logError("We encountered an error updating user: "+h.jsonMessage(n),null,"viewusers",!0)})}else f.logWarning("The user was NOT added",null,"viewusers",!0)})};return{title:"View Site Users",description:"Here is a list of the users on the site.",activate:a,attached:v,listOfUsers:l,addUser:k}});
//@ sourceMappingURL=viewusers.min.js.map