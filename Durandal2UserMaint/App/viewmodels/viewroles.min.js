define(["durandal/app","services/navigating","knockout","services/dataservice","jquery","services/logger","services/scripts","models/editAddRoleModel","models/listUsersInRolesModel"],function(n,t,i,r,u,f,e,o,s){function h(){t.busy(!0);var n=r.getRoleList(c);n.then(function(){t.busy(!1)}).fail(function(){t.busy(!1)})}var c=i.observableArray([]),l=function(){return h()},a=function(n){v(n)},v=function(n){u(n).on("click",".viewUsers",function(){var n=i.dataFor(this);w(n)});u(n).on("click",".editRole",function(){var n=i.dataFor(this);y(n)})},y=function(t){var i=new o(parseInt(t.RoleId),t.RoleName);i.viewUrl="views/addeditrole",n.showDialog(i).then(function(n){var t;n==="update"?(t=r.updateRole(i),t.then(function(){f.log("Role has been updated",null,null,"viewroles",!0),h()}).fail(function(n){f.logError("We encountered an error updating role: "+e.jsonMessage(n),null,"viewroles",!0)})):n==="delete"?(t=r.deleteRole(i),t.then(function(){f.log("Role has been deleted",null,null,"viewroles",!0),h()}).fail(function(n){f.logError("We encountered an error deleting role: "+e.jsonMessage(n),null,"viewroles",!0)})):f.logWarning("The role was NOT deleted",null,"viewroles",!0)})},p=function(){var t=new o(0,"");t.viewUrl="views/addeditrole",n.showDialog(t).then(function(n){if(n==="update"){var i=r.addRole(t);i.then(function(){f.log("Role has been added",null,null,"viewroles",!0),h()}).fail(function(n){f.logError("We encountered an error adding role: "+e.jsonMessage(n),null,"viewroles",!0)})}else f.logWarning("The role was NOT added",null,"viewroles",!0)})},w=function(t){var i=new s(t.RoleName);i.viewUrl="views/usersinrole",n.showDialog(i).then(function(){})};return{title:"View Site Roles",description:"Here is a list of the roles on the site.",activate:l,attached:a,listOfRoles:c,addRole:p}});
//@ sourceMappingURL=viewroles.min.js.map